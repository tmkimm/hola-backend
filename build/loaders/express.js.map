{"version":3,"file":"express.js","sourceRoot":"/","sources":["loaders/express.ts"],"names":[],"mappings":";;;;;AAAA,gEAAyC;AACzC,8CAAwB;AACxB,oDAA8B;AAC9B,0EAAkD;AAClD,8CAAwB;AACxB,gEAAyC;AACzC,0EAA2C;AAC3C,uDAAkC;AAClC,0DAAqC;AACrC,4DAAyC;AACzC,+DAA+C;AAE/C,mBAAe,UAAC,GAAwB;;IAGtC,IAAM,SAAS,GAAiB;QAC9B,uBAAuB;QACvB,uBAAuB;QACvB,qBAAqB;QACrB,sBAAsB;QACtB,yBAAyB;QACzB,0BAA0B;QAC1B,UAAU;KACX,CAAC;IACF,iFAAiF;IACjF,IAAM,WAAW,GAAG;QAClB,MAAM,EAAN,UAAO,MAA0B,EAAE,QAAkE;YACnG,IAAM,aAAa,GAAG,MAAM,IAAI,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;YACjE,QAAQ,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QAChC,CAAC;QACD,WAAW,EAAE,IAAI;KAClB,CAAC;IAEF,oBAAoB;IACpB,GAAG,CAAC,GAAG,CAAC,IAAA,cAAI,EAAC,WAAW,CAAC,CAAC,CAAC;IAC3B,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,IAAI,EAAE,CAAC,CAAC;IACxB,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IAChD,GAAG,CAAC,GAAG,CAAC,IAAA,uBAAY,GAAE,CAAC,CAAC;IACxB,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,MAAM,CAAC,cAAI,CAAC,IAAI,CAAC,cAAI,CAAC,OAAO,EAAE,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;IAE7D,eAAe;IACf,GAAG,CAAC,GAAG,CAAC,eAAM,CAAC,GAAG,CAAC,MAAM,EAAE,IAAA,eAAM,GAAE,CAAC,CAAC;IAErC,GAAG,CAAC,GAAG,CACL,CAAC,WAAW,CAAC,EACb,IAAA,4BAAgB,EAAC;QACf,SAAS,EAAE,IAAI;QACf,KAAK;YACH,GAAC,eAAM,CAAC,OAAO,IAAG,eAAM,CAAC,aAAa;eACvC;KACF,CAAC,CACH,CAAC;IACF,UAAU;IACV,IAAM,KAAK,GAAG,IAAA,uBAAY,EAAC,iBAAa,CAAC,CAAC;IAC1C,GAAG,CAAC,GAAG,CAAC,WAAW,EAAE,4BAAS,CAAC,KAAK,EAAE,4BAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;IAE9D,UAAU;IACV,IAAA,eAAQ,GAAE,CAAC;AACb,CAAC,EAAC","sourcesContent":["import cookieParser from 'cookie-parser';\nimport cors from 'cors';\nimport express from 'express';\nimport expressBasicAuth from 'express-basic-auth';\nimport path from 'path';\nimport swaggerJSDoc from 'swagger-jsdoc';\nimport swaggerUi from 'swagger-ui-express';\nimport routes from '../api/index';\nimport config from '../config/index';\nimport schedule from '../schedule/index';\nimport swaggerOption from '../swagger/swagger';\n\nexport default (app: express.Application) => {\n  type StaticOrigin = boolean | string | RegExp | (boolean | string | RegExp)[];\n\n  const whitelist: StaticOrigin = [\n    'http://localhost:3000',\n    'http://localhost:5173',\n    'http://holaworld.io',\n    'https://holaworld.io',\n    'http://www.holaworld.io',\n    'https://www.holaworld.io',\n    'ngork.io',\n  ];\n  // type StaticOrigin = boolean | string | RegExp | (boolean | string | RegExp)[];\n  const corsOptions = {\n    origin(origin: string | undefined, callback: (err: Error | null, singleOrigin?: StaticOrigin) => void) {\n      const isWhitelisted = origin && whitelist.indexOf(origin) !== -1;\n      callback(null, isWhitelisted);\n    },\n    credentials: true,\n  };\n\n  // Cors Whitelist 관리\n  app.use(cors(corsOptions));\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n  app.use(cookieParser());\n  app.use(express.static(path.join(path.resolve(), 'public')));\n\n  // API Route 설정\n  app.use(config.api.prefix, routes());\n\n  app.use(\n    ['/api-docs'],\n    expressBasicAuth({\n      challenge: true,\n      users: {\n        [config.AdminId]: config.AdminPassword,\n      },\n    })\n  );\n  // Swagger\n  const specs = swaggerJSDoc(swaggerOption);\n  app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));\n\n  // 스케줄러 실행\n  schedule();\n};\n"]}