{"version":3,"file":"post.js","sourceRoot":"/","sources":["schedule/post.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gEAAqC;AACrC,uCAA0D;AAC1D,2CAAgD;AAChD,uCAAmD;AACnD,uDAA2E;AAC3E;;EAEE;AAEF,QAAQ;AACR,SAAe,WAAW;;;;;;yBAEpB,CAAA,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,CAAA,EAArC,wBAAqC;oBACjC,IAAI,GAAG,IAAI,uBAAQ,CAAC,cAAc,EAAE,CAAC;oBAC3C,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;oBACd,IAAI,CAAC,EAAE,GAAG,YAAY,CAAC;oBAEX,qBAAM,uBAAQ,CAAC,WAAW,CAAC,IAAI,EAAE;;;;;;4CACrC,mBAAmB,GAAG,IAAI,mBAAW,CAAC,WAAS,EAAE,WAAS,EAAE,2BAAiB,CAAC,CAAC;4CACrF,qBAAM,mBAAmB,CAAC,WAAW,EAAE,EAAA;;4CAAvC,SAAuC,CAAC;;;;;yBACzC,CAAC,EAAA;;oBAHI,GAAG,GAAG,SAGV;;;;;;CAEL;AAEQ,kCAAW","sourcesContent":["import schedule from 'node-schedule';\r\nimport { IUser, User as UserModel } from '../models/User';\r\nimport { PostService } from '../services/index';\r\nimport { Post as PostModel } from '../models/Post';\r\nimport { Notification as NotificationModel } from '../models/Notification';\r\n/*\r\n  글에 관련된 Schedule을 정의한다.\r\n*/\r\n\r\n// 자동 마감\r\nasync function autoClosing() {\r\n  // 프로덕션 환경에서만 실행\r\n  if (process.env.NODE_ENV === 'production') {\r\n    const rule = new schedule.RecurrenceRule();\r\n    rule.hour = 0;\r\n    rule.tz = 'Asia/Seoul';\r\n\r\n    const job = await schedule.scheduleJob(rule, async function () {\r\n      const PostServiceInstance = new PostService(PostModel, UserModel, NotificationModel);\r\n      await PostServiceInstance.autoClosing();\r\n    });\r\n  }\r\n}\r\n\r\nexport { autoClosing };\r\n"]}