{"version":3,"file":"post.js","sourceRoot":"/","sources":["api/routes/post.ts"],"names":[],"mappings":"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","sourcesContent":["import { Router, Request, Response, NextFunction } from 'express';\nimport { Types } from 'mongoose';\nimport { IUser, User as UserModel } from '../../models/User';\nimport {\n  checkPost,\n  isPostValid,\n  isAccessTokenValid,\n  getUserIdByAccessToken,\n  isPostIdValid,\n} from '../middlewares/index';\nimport {\n  findPost,\n  findPostPagination,\n  findLastPage,\n  recommendToUserFromPost,\n  increaseView,\n  findPostDetail,\n  findUserLiked,\n  findLikeUsers,\n  registerPost,\n  modifyPost,\n  deletePost,\n  addLike,\n  deleteLike,\n} from '../../services/post';\nimport { asyncErrorWrapper } from '../../asyncErrorWrapper';\nimport { Post as PostModel } from '../../models/Post';\nimport { Notification as NotificationModel } from '../../models/Notification';\n\nconst route = Router();\n\nexport default (app: Router) => {\n  /**\n   * @swagger\n   * tags:\n        - name: posts\n          description: 글에 관련된 API\n   */\n  app.use('/posts', route);\n\n  // #region 글 리스트 조회(메인)\n  /**\n   * @swagger\n   * paths:\n   *   /posts:\n   *    get:\n   *      tags:\n   *        - posts\n   *      summary: 글 리스트 조회(메인)\n   *      description: 메인 페이지에서 글 리스트를 조회한다.\n   *      parameters:\n   *        - name: language\n   *          in: query\n   *          description: 사용 언어\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'react,java'\n   *        - name: offset\n   *          in: query\n   *          description: 건너뛸 개수\n   *          required: true\n   *          schema:\n   *            type: string\n   *          example: 00\n   *        - name: limit\n   *          in: query\n   *          description: 조회할 개수\n   *          required: true\n   *          schema:\n   *            type: string\n   *          example: 20\n   *        - name: sort\n   *          in: query\n   *          description: '정렬. 필드는 ,로 구분하며 +는 오름차순, -는 내림차순 '\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '-createdAt,+views'\n   *        - name: position\n   *          in: query\n   *          description: '직군(ALL: 전체, FE: 프론트엔드, BE: 백엔드, DE: 디자이너, IOS: IOS, AND: 안드로이드, DEVOPS: DevOps, PM)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'FE,IOS'\n   *        - name: type\n   *          in: query\n   *          description: '모집 구분(1 : 프로젝트, 2: 스터디)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '1'\n   *        - name: period\n   *          in: query\n   *          description: '조회 기간(일). 14일 경우 14일 이내의 글만 조회'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 14\n   *        - name: isClosed\n   *          in: query\n   *          description: '마감여부(true, false)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: true\n   *        - name: search\n   *          in: query\n   *          description: '검색'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '토이프로젝트'\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: array\n   *                items:\n   *                  $ref: '#/components/schemas/Post'\n   */\n  // #endregion\n  route.get(\n    '/',\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { offset, limit, sort, language, period, isClosed, type, position, search } = req.query;\n      const posts = await findPost(offset, limit, sort, language, period, isClosed, type, position, search);\n\n      return res.status(200).json(posts);\n    }),\n  );\n\n  // #region 글 리스트 조회(페이징)\n  /**\n   * @swagger\n   * paths:\n   *   /posts/pagination:\n   *    get:\n   *      tags:\n   *        - posts\n   *      summary: 글 리스트 조회(페이징)\n   *      description: 메인 페이지에서 글 리스트를 조회한다.\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: false\n   *          schema:\n   *            type: string\n   *        - name: language\n   *          in: query\n   *          description: 사용 언어\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'react,java'\n   *        - name: page\n   *          in: query\n   *          description: 현재 페이지(기본 1)\n   *          required: true\n   *          schema:\n   *            type: number\n   *          example: 3\n   *        - name: sort\n   *          in: query\n   *          description: '정렬. 필드는 ,로 구분하며 +는 오름차순, -는 내림차순 '\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '-createdAt,+views'\n   *        - name: position\n   *          in: query\n   *          description: '직군(FE: 프론트엔드, BE: 백엔드, DE: 디자이너, IOS: IOS, AND: 안드로이드, DEVOPS: DevOps, PM)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'FE,IOS'\n   *        - name: type\n   *          in: query\n   *          description: '모집 구분(1 : 프로젝트, 2: 스터디)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '1'\n   *        - name: period\n   *          in: query\n   *          description: '조회 기간(일). 14일 경우 14일 이내의 글만 조회'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 14\n   *        - name: isClosed\n   *          in: query\n   *          description: '마감여부(true, false)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: true\n   *        - name: search\n   *          in: query\n   *          description: '검색'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '토이프로젝트'\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: object\n   *                properties:\n   *                  posts:\n   *                    type: array\n   *                    items:\n   *                      $ref: '#/components/schemas/PostMain'\n   */\n  // #endregion\n  route.get(\n    '/pagination',\n    getUserIdByAccessToken,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { page, sort, language, period, isClosed, type, position, search } = req.query;\n      const { _id: userId } = req.user as IUser;\n      const posts = await findPostPagination(page, sort, language, period, isClosed, type, position, search, userId);\n\n      return res.status(200).json(posts);\n    }),\n  );\n\n  /**\n   * @swagger\n   * paths:\n   *   /posts/last-page:\n   *    get:\n   *      tags:\n   *        - posts\n   *      summary: 총 페이지 수 구하기\n   *      description: 마지막 페이지를 구한다.\n   *      parameters:\n   *        - name: language\n   *          in: query\n   *          description: 사용 언어\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'react,java'\n   *        - name: position\n   *          in: query\n   *          description: '직군(FE: 프론트엔드, BE: 백엔드, DE: 디자이너, IOS: IOS, AND: 안드로이드, DEVOPS: DevOps, PM)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 'FE,IOS'\n   *        - name: type\n   *          in: query\n   *          description: '모집 구분(1 : 프로젝트, 2: 스터디)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '1'\n   *        - name: period\n   *          in: query\n   *          description: '조회 기간(일). 14일 경우 14일 이내의 글만 조회'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: 14\n   *        - name: isClosed\n   *          in: query\n   *          description: '마감여부(true, false)'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: true\n   *        - name: search\n   *          in: query\n   *          description: '검색'\n   *          required: false\n   *          schema:\n   *            type: string\n   *          example: '토이프로젝트'\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: object\n   *                properties:\n   *                  lastPage:\n   *                    type: number\n   *                    description : '전체 페이지 수'\n   *                    example: 7\n   */\n  route.get(\n    '/last-page',\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { language, period, isClosed, type, position, search } = req.query;\n      const lastPage = await findLastPage(language, period, isClosed, type, position, search);\n\n      return res.status(200).json({\n        lastPage,\n      });\n    }),\n  );\n\n  // #region 글 상세에서 관련 글 추천\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}/recommend:\n   *    get:\n   *      tags:\n   *        - posts\n   *      summary: 글 상세에서 관련 글 추천\n   *      description: '사용자가 읽고 있는 글과 관련된 글을 추천한다. 같은 기술 스택인 글 / 조회수 순으로 정렬 / 사용자가 작성한 글을 제외하기 위해 access token 사용'\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: false\n   *          schema:\n   *            type: string\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '635a91e837ad67001412321a'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: array\n   *                items:\n   *                  $ref: '#/components/schemas/Post'\n   *        404:\n   *          description: Post not found\n   */\n  // #endregion\n  route.get(\n    '/:id/recommend',\n    getUserIdByAccessToken,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const postId = req.params.id;\n      const { _id: userId } = req.user as IUser;\n\n      const post = await recommendToUserFromPost(Types.ObjectId(postId), userId);\n      // const post = await PostServiceInstance.findPopularPosts(Types.ObjectId(postId), userId);  // 무조건 인기글 순으로 조회\n\n      return res.status(200).json(post);\n    }),\n  );\n\n  // #region 글 상세 보기\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}:\n   *    get:\n   *      tags:\n   *        - posts\n   *      summary: 글 상세 보기\n   *      description: '글 상세 정보를 조회한다. 읽은 목록 추가를 위해 access token을 사용한다.'\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: false\n   *          schema:\n   *            type: string\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '635a91e837ad67001412321a'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: array\n   *                items:\n   *                  $ref: '#/components/schemas/Post'\n   *        404:\n   *          description: Post not found\n   */\n  // #endregion\n  route.get(\n    '/:id',\n    getUserIdByAccessToken,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const postId = req.params.id;\n      const { _id: userId } = req.user as IUser;\n      const readList = req.cookies.RVIEW;\n\n      const post = await findPostDetail(Types.ObjectId(postId));\n      const { updateReadList, isAlreadyRead } = await increaseView(Types.ObjectId(postId), userId, readList);\n      if (!isAlreadyRead) {\n        // 쿠키는 당일만 유효\n        const untilMidnight = new Date();\n        untilMidnight.setHours(24, 0, 0, 0);\n        res.cookie('RVIEW', updateReadList, {\n          sameSite: 'none',\n          httpOnly: true,\n          secure: true,\n          expires: untilMidnight,\n        });\n      }\n      return res.status(200).json(post);\n    }),\n  );\n\n  // #region 글 등록\n  /**\n   * @swagger\n   * paths:\n   *   /posts:\n   *    post:\n   *      tags:\n   *        - posts\n   *      summary: 글 등록\n   *      description: '신규 글을 등록한다.'\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: true\n   *          schema:\n   *            type: string\n   *      requestBody:\n   *        content:\n   *          application/json:\n   *            schema:\n   *              $ref: '#/components/schemas/Post'\n   *      responses:\n   *        201:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: array\n   *                items:\n   *                  $ref: '#/components/schemas/Post'\n   *        400:\n   *          description: Invaild post data\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   */\n  // #endregion\n  route.post(\n    '/',\n    checkPost,\n    isPostValid,\n    isAccessTokenValid,\n    asyncErrorWrapper(async function (req: Request, res: Response, next: NextFunction) {\n      try {\n        const postDTO = req.body;\n        const { _id: userId } = req.user as IUser;\n\n        const post = await registerPost(userId, postDTO);\n        return res.status(201).json(post);\n      } catch (error) {\n        return res.status(400).json({\n          errors: [\n            {\n              location: 'body',\n              param: 'name',\n              error: 'TypeError',\n              message: 'must be String',\n            },\n          ],\n          error,\n        });\n      }\n    }),\n  );\n\n  // #region 글 수정\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}:\n   *    patch:\n   *      tags:\n   *        - posts\n   *      summary: 글 수정\n   *      description: 글을 수정한다.\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: true\n   *          schema:\n   *            type: string\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '635a91e837ad67001412321a'\n   *          schema:\n   *            type: string\n   *      requestBody:\n   *        content:\n   *          application/json:\n   *            schema:\n   *              $ref: '#/components/schemas/Post'\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: array\n   *                items:\n   *                  $ref: '#/components/schemas/Post'\n   *        400:\n   *          description: Invaild post data\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   */\n  // #endregion\n  route.patch(\n    '/:id',\n    isAccessTokenValid,\n    checkPost,\n    isPostValid,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { id } = req.params;\n      const { _id: tokenUserId, tokenType } = req.user as IUser;\n\n      const postDTO = req.body;\n\n      const post = await modifyPost(Types.ObjectId(id), tokenUserId, tokenType, postDTO);\n\n      return res.status(200).json(post);\n    }),\n  );\n\n  // #region 글 삭제\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}:\n   *    delete:\n   *      tags:\n   *        - posts\n   *      summary: 글 삭제\n   *      description: 글을 삭제한다.\n   *      parameters:\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '60213d1c3126991a7cd1d287'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        204:\n   *          description: successful operation\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   *        404:\n   *          description: Post not found\n   */\n  // #endregion\n  route.delete(\n    '/:id',\n    isPostIdValid,\n    isAccessTokenValid,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { id } = req.params;\n      const { _id: tokenUserId, tokenType } = req.user as IUser;\n\n      await deletePost(Types.ObjectId(id), tokenUserId, tokenType);\n      return res.status(204).json();\n    }),\n  );\n\n  /**\n   * @swagger\n   * tags:\n        - name: likes\n          description: 글 관심 등록\n   */\n  // #region 좋아요 등록\n  /**\n   * @swagger\n   * paths:\n   *   /posts/likes:\n   *    post:\n   *      tags:\n   *        - likes\n   *      summary: 좋아요 등록\n   *      description: 좋아요 등록\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: true\n   *          schema:\n   *            type: string\n   *      requestBody:\n   *        content:\n   *          application/json:\n   *            schema:\n   *              type: object\n   *              properties:\n   *                postId:\n   *                  type: string\n   *                  description : '글 ID'\n   *                  example: '61063af4ed4b420bbcfa0b4c'\n   *      responses:\n   *        201:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: object\n   *                properties:\n   *                  likeUsers:\n   *                    type: array\n   *                    description: 사용자 리스트\n   *                    items:\n   *                      type: string\n   *        400:\n   *          description: Invaild post data\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   */\n  // #endregion\n  route.post(\n    '/likes',\n    isAccessTokenValid,\n    isPostIdValid,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const { postId } = req.body;\n      const { _id: userId } = req.user as IUser;\n\n      const post = await addLike(Types.ObjectId(postId), userId);\n\n      return res.status(201).json({ likeUsers: post.likes });\n    }),\n  );\n\n  /**\n   * @swagger\n   * paths:\n   *   /posts/likes/{id}:\n   *    delete:\n   *      tags:\n   *        - likes\n   *      summary: 좋아요 삭제\n   *      description: 좋아요 삭제\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: true\n   *          schema:\n   *            type: string\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '60213d1c3126991a7cd1d287'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        204:\n   *          description: successful operation\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   *        404:\n   *          description: Post not found\n   */\n  route.delete(\n    '/likes/:id',\n    isAccessTokenValid,\n    isPostIdValid,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const postId = req.params.id; // 사용자 id\n      const { _id: userId } = req.user as IUser;\n\n      const post = await deleteLike(Types.ObjectId(postId), userId);\n      return res.status(201).json({ likeUsers: post.likes });\n    }),\n  );\n\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}/isLiked:\n   *    get:\n   *      tags:\n   *        - likes\n   *      summary: 사용자의 글 관심 등록 여부\n   *      description: '사용자가 글에 관심 등록을 눌렀는지 여부를 조회한다. 사용자 정보는 access token을 이용해 확인한다.'\n   *      parameters:\n   *        - name: accessToken\n   *          in: header\n   *          description: access token\n   *          required: false\n   *          schema:\n   *            type: string\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '635a91e837ad67001412321a'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: object\n   *                properties:\n   *                  isLiked:\n   *                    type: boolean\n   *                    description : 'true, false'\n   *        401:\n   *          $ref: '#/components/responses/UnauthorizedError'\n   */\n  route.get(\n    '/:id/isLiked',\n    getUserIdByAccessToken,\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const postId = req.params.id;\n      const { _id: userId } = req.user as IUser;\n\n      const isLiked = await findUserLiked(Types.ObjectId(postId), userId);\n\n      return res.status(200).json({\n        isLiked,\n      });\n    }),\n  );\n\n  /**\n   * @swagger\n   * paths:\n   *   /posts/{id}/likes:\n   *    get:\n   *      tags:\n   *        - likes\n   *      summary: 글의 관심 등록한 사용자 리스트 조회\n   *      description: '사용자가 글에 관심 등록한 사용자 리스트를 조회한다.'\n   *      parameters:\n   *        - name: id\n   *          in: path\n   *          description: 글 Id\n   *          required: true\n   *          example: '61063af4ed4b420bbcfa0b4c'\n   *          schema:\n   *            type: string\n   *      responses:\n   *        200:\n   *          description: successful operation\n   *          content:\n   *            application/json:\n   *              schema:\n   *                type: object\n   *                properties:\n   *                  likeUsers:\n   *                    type: array\n   *                    description: 사용자 리스트\n   *                    items:\n   *                      type: string\n   */\n  route.get(\n    '/:id/likes',\n    asyncErrorWrapper(async (req: Request, res: Response, next: NextFunction) => {\n      const postId = req.params.id;\n      const likeUsers = await findLikeUsers(Types.ObjectId(postId));\n\n      return res.status(200).json({\n        likeUsers,\n      });\n    }),\n  );\n};\n"]}