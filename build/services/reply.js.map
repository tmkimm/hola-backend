{"version":3,"file":"reply.js","sourceRoot":"/","sources":["services/reply.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;IACE,sBAAsB,SAAqB,EAAY,iBAAqC;QAAtE,cAAS,GAAT,SAAS,CAAY;QAAY,sBAAiB,GAAjB,iBAAiB,CAAoB;IAAG,CAAC;IAEhG,gBAAgB;IACV,oCAAa,GAAnB,UACE,MAAsB,EACtB,MAAsB,EACtB,SAAyB,EACzB,OAAe,EACf,QAAgB;;;;;4BAEU,qBAAM,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,CAAC,EAAA;;wBAA1F,KAAoB,SAAsE,EAAxF,IAAI,UAAA,EAAE,OAAO,aAAA;wBAGN,qBAAM,IAAI,CAAC,SAAS,CAAC,qBAAqB,CAAC,SAAS,CAAC,EAAA;;wBAA9D,MAAM,GAAG,SAAqD;wBACpE,IAAI,MAAM,KAAK,IAAI;4BACjB,kHAAkH;4BAElH,sBAAO,IAAI,EAAC;;;;;KACf;IAED,aAAa;IACP,kCAAW,GAAjB,UAAkB,OAAuB,EAAE,WAA2B;;;;;4BACpE,qBAAM,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,CAAC,EAAA;;wBAAtE,SAAsE,CAAC;wBACjD,qBAAM,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,EAAA;;wBAAzD,aAAa,GAAG,SAAyC;wBAC/D,sBAAO,aAAa,EAAC;;;;KACtB;IAED,aAAa;IACP,kCAAW,GAAjB,UAAkB,OAAuB,EAAE,MAAsB;;;;;4BAC/D,qBAAM,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,OAAO,EAAE,MAAM,CAAC,EAAA;;wBAA7D,SAA6D,CAAC;wBAC/C,qBAAM,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAA;;wBAA1D,MAAM,GAAG,SAAiD;wBAC7C,qBAAM,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,EAAA;;wBAAtD,UAAU,GAAG,SAAyC;;;;;KAE7D;IACH,mBAAC;AAAD,CAAC,AAnCD,IAmCC;AAnCY,oCAAY","sourcesContent":["import { Types } from 'mongoose';\nimport { IReplyDocument, IPostModel, IComment } from '../models/Post';\nimport { INotificationModel } from '../models/Notification';\n\nexport class ReplyService {\n  constructor(protected postModel: IPostModel, protected notificationModel: INotificationModel) {}\n\n  // 신규 대댓글을 추가한다.\n  async registerReply(\n    userID: Types.ObjectId,\n    postId: Types.ObjectId,\n    commentId: Types.ObjectId,\n    content: string,\n    nickName: string,\n  ) {\n    const { post, replyId } = await this.postModel.registerReply(postId, commentId, content, userID);\n\n    // 대댓글 등록 시 댓글 등록자에게 달림 추가\n    const author = await this.postModel.findAuthorByCommentId(commentId);\n    if (author !== null)\n      // await this.notificationModel.registerNotification(postId, author, userID, 'reply', replyId, nickName); // 알림 등록\n\n      return post;\n  }\n\n  // 대댓글을 수정한다.\n  async modifyReply(comment: IReplyDocument, tokenUserId: Types.ObjectId) {\n    await this.postModel.checkReplyAuthorization(comment._id, tokenUserId);\n    const commentRecord = await this.postModel.modifyReply(comment);\n    return commentRecord;\n  }\n\n  // 대댓글을 삭제한다.\n  async deleteReply(replyId: Types.ObjectId, userId: Types.ObjectId) {\n    await this.postModel.checkReplyAuthorization(replyId, userId);\n    const author = await this.postModel.findAuthorByReplyId(replyId);\n    const postRecord = await this.postModel.deleteReply(replyId);\n    // await this.notificationModel.deleteNotification(replyId); // 알림 삭제\n  }\n}\n"]}