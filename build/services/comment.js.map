{"version":3,"file":"comment.js","sourceRoot":"/","sources":["services/comment.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;IACE,wBAAsB,SAAqB,EAAY,iBAAqC;QAAtE,cAAS,GAAT,SAAS,CAAY;QAAY,sBAAiB,GAAjB,iBAAiB,CAAoB;QAC1F,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;IAC7C,CAAC;IAED,0BAA0B;IACpB,qCAAY,GAAlB,UAAmB,EAAkB;;;;;4BAClB,qBAAM,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE,CAAC,EAAA;;wBAAhD,QAAQ,GAAG,SAAqC;wBACtD,sBAAO,QAAQ,EAAC;;;;KACjB;IAED,eAAe;IACT,wCAAe,GAArB,UAAsB,MAAsB,EAAE,MAAsB,EAAE,OAAe,EAAE,QAAgB;;;;;4BACzE,qBAAM,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC,EAAA;;wBAAnF,KAAsB,SAA6D,EAAjF,IAAI,UAAA,EAAE,SAAS,eAAA;wBACvB,2HAA2H;wBAC3H,sBAAO,IAAI,EAAC;;;;KACb;IAED,YAAY;IACN,sCAAa,GAAnB,UAAoB,OAAyB,EAAE,WAA2B;;;;;4BACxE,qBAAM,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,CAAC,EAAA;;wBAAxE,SAAwE,CAAC;wBACnD,qBAAM,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,EAAA;;wBAA3D,aAAa,GAAG,SAA2C;wBACjE,sBAAO,aAAa,EAAC;;;;KACtB;IAED,YAAY;IACN,sCAAa,GAAnB,UAAoB,SAAyB,EAAE,MAAsB;;;;;4BACnE,qBAAM,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,SAAS,EAAE,MAAM,CAAC,EAAA;;wBAAjE,SAAiE,CAAC;wBAE/C,qBAAM,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,SAAS,CAAC,EAAA;;wBAA1D,UAAU,GAAG,SAA6C;;;;;KAEjE;IACH,qBAAC;AAAD,CAAC,AAjCD,IAiCC;AAjCY,wCAAc","sourcesContent":["import { Types } from 'mongoose';\nimport { ICommentDocument, IComment, IPostModel } from '../models/Post';\nimport { INotificationModel } from '../models/Notification';\n\nexport class CommentService {\n  constructor(protected postModel: IPostModel, protected notificationModel: INotificationModel) {\n    this.postModel = postModel;\n    this.notificationModel = notificationModel;\n  }\n\n  // 글 id를 이용해 댓글 리스트를 조회한다.\n  async findComments(id: Types.ObjectId) {\n    const comments = await this.postModel.findComments(id);\n    return comments;\n  }\n\n  // 신규 댓글을 추가한다.\n  async registerComment(userID: Types.ObjectId, postId: Types.ObjectId, content: string, nickName: string) {\n    const { post, commentId } = await this.postModel.registerComment(postId, content, userID);\n    // await this.notificationModel.registerNotification(postId, post.author, userID, 'comment', commentId, nickName); // 알림 등록\n    return post;\n  }\n\n  // 댓글을 수정한다.\n  async modifyComment(comment: ICommentDocument, tokenUserId: Types.ObjectId) {\n    await this.postModel.checkCommentAuthorization(comment._id, tokenUserId);\n    const commentRecord = await this.postModel.modifyComment(comment);\n    return commentRecord;\n  }\n\n  // 댓글을 삭제한다.\n  async deleteComment(commentId: Types.ObjectId, userId: Types.ObjectId) {\n    await this.postModel.checkCommentAuthorization(commentId, userId);\n\n    const postRecord = await this.postModel.deleteComment(commentId);\n    // await this.notificationModel.deleteNotification(commentId); // 알림 삭제\n  }\n}\n"]}