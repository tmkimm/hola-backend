{"version":3,"file":"comment.js","sourceRoot":"/","sources":["services/comment.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;IACE,wBACY,SAAqB,EACrB,iBAAqC;QADrC,cAAS,GAAT,SAAS,CAAY;QACrB,sBAAiB,GAAjB,iBAAiB,CAAoB;QAE/C,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;IAC7C,CAAC;IAED,0BAA0B;IACpB,qCAAY,GAAlB,UAAmB,EAAkB;;;;;4BAClB,qBAAM,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE,CAAC,EAAA;;wBAAhD,QAAQ,GAAG,SAAqC;wBACtD,sBAAO,QAAQ,EAAC;;;;KACjB;IAED,eAAe;IACT,wCAAe,GAArB,UAAsB,MAAsB,EAAE,MAAsB,EAAE,OAAe,EAAE,QAAgB;;;;;4BACzE,qBAAM,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC,EAAA;;wBAAnF,KAAsB,SAA6D,EAAjF,IAAI,UAAA,EAAE,SAAS,eAAA;wBACvB,yHAAyH;wBACzH,sBAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,EAAC;;;;KAC5B;IAED,YAAY;IACN,sCAAa,GAAnB,UAAoB,OAAyB,EAAE,WAA2B,EAAE,SAAiB;;;;;4BAC3F,qBAAM,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,EAAE,SAAS,CAAC,EAAA;;wBAAnF,SAAmF,CAAC;wBAC9D,qBAAM,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,EAAA;;wBAA3D,aAAa,GAAG,SAA2C;wBACjE,sBAAO,aAAa,EAAC;;;;KACtB;IAED,YAAY;IACN,sCAAa,GAAnB,UAAoB,SAAyB,EAAE,MAAsB,EAAE,SAAiB;;;;;4BACtF,qBAAM,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,SAAS,EAAE,MAAM,EAAE,SAAS,CAAC,EAAA;;wBAA5E,SAA4E,CAAC;wBAC1D,qBAAM,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,SAAS,CAAC,EAAA;;wBAA1D,UAAU,GAAG,SAA6C;wBAChE,qBAAM,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,SAAS,CAAC,EAAA;;wBAA1D,SAA0D,CAAC,CAAC,QAAQ;;;;;KACrE;IACH,qBAAC;AAAD,CAAC,AAnCD,IAmCC;AAnCY,wCAAc","sourcesContent":["import { Types } from 'mongoose';\nimport { INotificationModel } from '../models/Notification';\nimport { ICommentDocument, IPostModel } from '../models/Post';\n\nexport class CommentService {\n  constructor(\n    protected postModel: IPostModel,\n    protected notificationModel: INotificationModel\n  ) {\n    this.postModel = postModel;\n    this.notificationModel = notificationModel;\n  }\n\n  // 글 id를 이용해 댓글 리스트를 조회한다.\n  async findComments(id: Types.ObjectId) {\n    const comments = await this.postModel.findComments(id);\n    return comments;\n  }\n\n  // 신규 댓글을 추가한다.\n  async registerComment(userID: Types.ObjectId, postId: Types.ObjectId, content: string, nickName: string) {\n    const { post, commentId } = await this.postModel.registerComment(postId, content, userID);\n    //await this.notificationModel.createCommentNotice(postId, post.author, userID, 'comment', commentId, nickName); // 알림 등록\n    return { post, commentId };\n  }\n\n  // 댓글을 수정한다.\n  async modifyComment(comment: ICommentDocument, tokenUserId: Types.ObjectId, tokenType: string) {\n    await this.postModel.checkCommentAuthorization(comment._id, tokenUserId, tokenType);\n    const commentRecord = await this.postModel.modifyComment(comment);\n    return commentRecord;\n  }\n\n  // 댓글을 삭제한다.\n  async deleteComment(commentId: Types.ObjectId, userId: Types.ObjectId, tokenType: string) {\n    await this.postModel.checkCommentAuthorization(commentId, userId, tokenType);\n    const postRecord = await this.postModel.deleteComment(commentId);\n    await this.notificationModel.deleteNotification(commentId); // 알림 삭제\n  }\n}\n"]}