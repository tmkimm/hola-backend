{"version":3,"file":"jwt.js","sourceRoot":"/","sources":["utills/jwt.ts"],"names":[],"mappings":";;;;;;AAAA,8DAA+C;AAC/C,iDAA2C;AAC3C,0DAAqC;AAOrC,SAAgB,OAAO,CAAC,OAAmB,EAAE,SAAiB;IAC5D,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QACjC,sBAAG,CAAC,IAAI,CACN,OAAO,EACP,eAAM,CAAC,YAAY,EACnB;YACE,SAAS,WAAA;YACT,MAAM,EAAE,eAAM,CAAC,MAAM;SACtB,EACD,UAAC,GAAG,EAAE,KAAK;YACT,IAAI,GAAG,IAAI,CAAC,IAAA,wBAAQ,EAAC,KAAK,CAAC;gBAAE,MAAM,CAAC,GAAG,CAAC,CAAC;YACzC,OAAO,CAAC,KAAe,CAAC,CAAC;QAC3B,CAAC,CACF,CAAC;IACJ,CAAC,CAAC,CAAC;AACL,CAAC;AAfD,0BAeC;AAED,SAAgB,SAAS,CAAC,KAAa;IACrC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QACjC,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,eAAM,CAAC,YAAY,EAAE,UAAC,GAAG,EAAE,OAAY;YACvD,IAAI,GAAG;gBAAE,MAAM,CAAC,GAAG,CAAC,CAAC;YACrB,OAAO,CAAC,OAAO,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC;AAPD,8BAOC;AAED,SAAgB,kBAAkB,CAAC,OAA4B;IAC7D,OAAO,CAAC,CAAC,CAAC,OAAO,OAAO,KAAK,QAAQ,IAAK,CAAC,SAAS,IAAI,OAAO,CAAS,CAAC,CAAC;AAC5E,CAAC;AAFD,gDAEC","sourcesContent":["import JWT, { JwtPayload } from 'jsonwebtoken';\r\nimport { isString } from './isStringEmpty';\r\nimport config from '../config/index';\r\n\r\ntype jwtPayload = {\r\n  nickName?: string;\r\n  idToken?: string;\r\n  _id?: string;\r\n};\r\nexport function signJWT(payload: jwtPayload, expiresIn: string): Promise<JWT.Secret> {\r\n  return new Promise((resolve, reject) => {\r\n    JWT.sign(\r\n      payload,\r\n      config.jwtSecretKey,\r\n      {\r\n        expiresIn,\r\n        issuer: config.issuer,\r\n      },\r\n      (err, token) => {\r\n        if (err || !isString(token)) reject(err);\r\n        resolve(token as string);\r\n      },\r\n    );\r\n  });\r\n}\r\n\r\nexport function verifyJWT(token: string): Promise<any> {\r\n  return new Promise((resolve, reject) => {\r\n    JWT.verify(token, config.jwtSecretKey, (err, decoded: any) => {\r\n      if (err) reject(err);\r\n      resolve(decoded);\r\n    });\r\n  });\r\n}\r\n\r\nexport function isValidAccessToken(decoded: string | JwtPayload): boolean {\r\n  return !!(typeof decoded !== 'string' && (('idToken' in decoded) as any));\r\n}\r\n"]}